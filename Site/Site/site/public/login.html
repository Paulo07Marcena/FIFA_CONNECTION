<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login | Cadastro</title>
    <link rel="shortcut icon" href="./IMG/LOGO.png" type="image/x-icon">
    <link rel="shortcut icon" href="/IMG/LOGO.png" type="image/x-icon" />
    <link rel="stylesheet" href="./CSS/Padrao.css" />
    <link rel="stylesheet" href="./CSS/Headers.css" />
    <link rel="stylesheet" href="./CSS/loginCadastro.css" />

    <!-- Link para o toastr -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  </head>
  <body>
    <header class="header01">
      <div>
        <a href="./index.html">
          <p class="FIFA colorGold">FIFA</p>
          <p class="connection">CONNECTION</p>
        </a>
      </div>
      <div>
        <ul>
          <li><a href="modoCarreiraTreinador.html"./">MODO CARREIRA TREINADOR</a></li>
          <li class="colorGold">|</li>
          <li><a href="modoCarreiraJogador.html">MODO CARREIRA JOGADOR</a></li>
          <li class="colorGold">|</li>
          <li><a href="./Simulador.html">TIME DOS SONHOS</a></li>
          <li class="colorGold">|</li>
          <li><a href="./jogador.html">JOGADORES</a></li>
          <li class="colorGold">|</li>
          <li>
            <a href="./login.html"><img src="./IMG/user1.png" alt="" /></a>
          </li>
        </ul>
      </div>
    </header>
    <section class="section">
      <div class="content">
        <div id="setor01" class="setores">
          <div>
            <img src="IMG/cadastro.png" alt="" />
            <h1>CRIAR CONTA</h1>
          </div>
          <div>
            <input class="user-ipt" id="ipt_cadastro_nome" placeholder="NOME" />
            <input
              class="email-ipt"
              id="ipt_cadastro_email"
              placeholder="EMAIL"
            />
            <input
              class="senha-ipt"
              id="ipt_cadastro_senha"
              type="password"
              placeholder="SENHA"
            />
          </div>
          <div>
            <button onclick="cadastrar()">Criar conta</button>
          </div>
        </div>
        <div class="setores">
          <div>
            <img src="./IMG/aplicativo-web (1).png" alt="" />
            <h1>ENTRAR</h1>
          </div>

          <div>
            <input class="email-ipt" id="ipt_email" placeholder="EMAIL" />
            <input class="senha-ipt" id="ipt_senha" placeholder="SENHA" />
           </div>
          <div>
            <button>Entrar</button>
          </div>
        </div>
        <!--  -->
        <div id="conteudoBox" class="setores banner banner02">
          <div id="conteudo" class="setores banner banner02">
            <h1>Bem-vindo de volta!</h1>
            <p>Se mantenha conectado fazendo login com as suas informações!</p>
            <button onclick="setorLogin(1)">Já tenho uma conta</button>
          </div>
        </div>
      </div>
    </section>
  </body>
</html>


<script src="./JavaScript/login.js"></script>
<script src="js/funcoes.js"></script>
<script>
  var erro = false;

  function cadastrar() {
    aguardar();

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var cadastroNome = ipt_cadastro_nome.value;
    var cadastroEmail = ipt_cadastro_email.value;
    var cadastroSenha = ipt_cadastro_senha.value;

    if (
      (cadastroNome == "" || ipt_cadastro_nome.length <= 1) ||
      (cadastroEmail == "" || cadastroEmail.indexOf("@") == -1) ||
      (cadastroSenha == "" || ipt_cadastro_senha.length <= 6)
    ) {
      toastr.error(`Os dados fornecidos não estão de acordo. Verifique os campos`);
      
      erro = true;
      finalizarAguardar();
      return false;
    } 
     
    if (erro == false){
    // Enviando o valor da nova input
    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: cadastroNome,
        emailServer: cadastroEmail,
        senhaServer: cadastroSenha
        
      }),
      
    })
    .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
  
            toastr.success("Cadastro realizado com sucesso!");
            transition(1);
  
            setTimeout(() => {
  
              ipt_cadastro_email.value = "";
              ipt_cadastro_nome.value = "";
              ipt_cadastro_senha.value = "";
  
            }, "2000");


        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        finalizarAguardar();
      });

    return false;

    }
  }








  toastr.options = {
  "closeButton": false,
  "debug": false,
  "newestOnTop": false,
  "progressBar": false,
  "positionClass": "toast-bottom-right",
  "preventDuplicates": false,
  "onclick": null,
  "showDuration": "300",
  "hideDuration": "1000",
  "timeOut": "5000",
  "extendedTimeOut": "1000",
  "showEasing": "swing",
  "hideEasing": "linear",
  "showMethod": "fadeIn",
  "hideMethod": "fadeOut"
}
</script>